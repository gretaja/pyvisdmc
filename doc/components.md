# **Defining Components for the Project**

## **Data Source (PyVibDMC Output File)**

**What it does:**  
Provides the raw simulation data in the form of an `.hdf5` file generated by PyVibDMC.

**Inputs:**  
None (we assume the `.hdf5` file already exists on the user’s machine).

**Outputs:**  
An `.hdf5` file containing simulation data (energies, coordinates, etc.) ready for analysis.

**Talks to:**  
data loader (data_loader.py) 

---

## **Configuration File (config.yaml)**

**What it does:**  
Specifies all required parameters for analysis in a single YAML file. This includes the path to the data, the simulation parameters (molecule name, number of walkers, timesteps), the start/stop range for analysis, and which plots to generate.

**Inputs:**  
User-written YAML file with keys `data_path`, `molecule`, `sim_num`, `walkers`, `timesteps`, `start`, `stop`, and `plots`. Some plots may require additional keys (e.g., `dist` for `one_dist`).

**Outputs:**  
A dictionary of parameters read by `main.py` to direct the data loading and plotting process.

**Talks to:**  
main script (main.py) to retrieve user specifications and direct plot generation

---

## **Main Script (main.py)**

**What it does:**

* Reads the `config.yaml` file.  
* Validates parameters (e.g., checking that `data_path` is a valid directory, `start < stop`, etc.).  
* Calls the **Data Loader** to load simulation data.  
* Based on the plots requested in `config.yaml`, calls the appropriate plotting functions.  
* Saves the resulting plots as `.png` files.

**Inputs:**

* parameters from `config.yaml` (dictionary)

**Outputs:**

* Printed PyVisDMC startup message, with text art that I had so much fun making :)  
* Printed description of package version
* Printed descrription of key info about the simulation the user is trying to analyze  
* Error messages if any configuration parameters are invalid.  
* Invocations of plotting functions to produce `.png` files.  
* Printed messages indicating success or failure.

**Talks to:**  
configuration file, data loader, all plotting components

---

## **Data Loader (data_loader.py)**

**What it does:**

* Loads `.hdf5` simulation data from the specified `data_path`.  
* Extracts coordinates and weights for specified time ranges.  
* Provides `sim_data` to plotting functions.

**Inputs:**

* `data_path`, `molecule`, `sim_num`, `walkers`, `timesteps`, `start`, `stop` from the config (which is enough to direct the program to an existing `.hdf5` file containing PyVibDMC simulation data)

**Outputs:**

* A simulation data object (`sim_data`) compatible with plotting functions.  
* `analyzer` and `weights` arrays for plotting purposes.

**Talks to:**  
main script and plotting components

**Side effects:**  
If the data cannot be loaded (e.g., missing files, wrong parameters), raises a `ValueError` which `main.py` reports to the user.

## **`eref` Plot Component (eref.py)**

**What it does:**  
Generates a line plot of the average energy of the ensemble over the given time range and calculates the zero-point energy (ZPE) based on user-specified start and stop timesteps. This is a quick way to understand the energy convergence behavior of the DMC simulation.

**Inputs:**

* `molecule` (string): the name of the molecule  
* `sim_num` (int): simulation number  
* `sim_data` (pyvibdmc SimInfo object): loaded simulation data from the data loader  
* `start` (int), `stop` (int): time range for which to perform analysis

**Outputs:**

* A `.png` file showing the energy vs. timestep line plot and a horizontal line indicating the ZPE

**Talks to:**

* Main script (`main.py`): calls `plot_eref` after loading and validating data  
* Data loader (`data_loader.py`): provides the `sim_data` object containing energy values  
* Data validation is handled by testing functions that raise errors in the user inputs before `plot_eref` executes

**Side Effects:**

* On success, creates a `.png` plot and prints a confirmation message.

---

## **`one_dist` Plot Component (one\_dist.py)**

**What it does:**  
Creates a histogram of a single bond length distribution from the simulation data. This helps the user understand the probability distribution of a specific atomic pair’s distance.

**Inputs:**

* `molecule` (string): name of the molecule  
* `analyzer`, `weights` (arrays): geometric data organized by the data loader  
* `dist` (list of two integers): atom indices specifying which bond length to analyze.

**Outputs:**

* A `.png` file showing the probability distribution of the specified bond length.

**Talks to:**

* Main script (`main.py`) for invocation after data loading.  
* Data loader (`data_loader.py`) to provide `analyzer` and `weights`.  
* Testing functions run before `plot_dist` to ensure:  
  * The `dist` parameter is present and has exactly two indices  
  * The simulation data includes coordinates for the specified atoms  
* If validation fails, the tests raise errors before the plotting function runs

**Side Effects:**

* On success, a `.png` file with the distribution plot is saved and a confirmation message is printed

---

## **`mult_dist` Plot Component (mult\_dist.py)**

**What it does:**  
Generates multiple histograms for several specified bond lengths simultaneously, allowing the user to compare distributions of different bonds within the same simulation. (Essentially, this is just multiple one_dist plots on top of each other.)

**Inputs:**

* `molecule` (string)  
* `sim_num` (int)  
* `analyzer`, `weights` (arrays from data loader)  
* `mult_dists` (list of `[i,j]` pairs): multiple sets of atom indices that specify which bond lengths to analyze

**Outputs:**

* A `.png` file showing multiple bond length distributions on the same plot.

**Talks to:**

* Main script (`main.py`) and data loader (`data_loader.py`)  
* Again, pre-execution tests check
  * that `mult_dists` is provided and each element is a pair of integers  
  * that the simulation data contains all requested atom indices  
* Invalid parameters or missing data fields cause test functions to fail, preventing the plot from running.

**Side Effects:**

* On success, saves a `.png` file and prints a confirmation message.

---

## **`two_d_dist` Plot Component (two\_d\_dist.py)**

**What it does:**  
Creates a 2D probability plot comparing two different sets of bond lengths. The x and y axes each correspond to a single set of bonds, and the probability of finding yourself at a given location in the xy-plane is mapped as a color bar.

**Inputs:**

* `molecule` (string)  
* `sim_num` (int)  
* `analyzer`, `weights` (arrays from data loader)  
* `2d_dists` (list of two `[i,j]` pairs): defines the two bond lengths to plot against each other on x and y axes

**Outputs:**

* A `.png` file showing the 2D distribution of the specified parameters.

**Talks to:**

* Main script (`main.py`) and data loader (`data_loader.py`).  
* Pre-run tests confirm:  
  * `2d_dists` is present and contains exactly two pairs of atom indices  
  * The available data supports both requested parameters  
* Any failure in these tests will throw an error before  `plot_2d` is called

**Side Effects:**

* On success, saves a `.png` file and prints a success message.
